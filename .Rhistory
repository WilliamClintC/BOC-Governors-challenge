inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
coeftest(VAR2, vcov. = sandwich)
GDP<-DlogGDP
CPI<-DlogCPI
Unemployment<-DlogUnemplyoment
Wages<-DlogWages
`Balance of Payments`<-DlogBOP
Consumption <-DlogCS
Investment<-DlogII
Rate<-DlogRate
VAR_data <- window(ts.union(GDP,CPI,Unemployment,Wages,`Balance of Payments`,Consumption,Investment,Rate), start=c(2021,3), end = c(2023,1))
VAR_est <- VAR(y = VAR_data, p = 2)
VAR_est
forecast <- predict(VAR_est)
par(mar = c(2, 1, 1, 1))
forecast
plot(forecast)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
coeftest(VAR2, vcov. = sandwich)
GDP<-DlogGDP
CPI<-DlogCPI
Unemployment<-DlogUnemplyoment
Wages<-DlogWages
`Balance of Payments`<-DlogBOP
Consumption <-DlogCS
Investment<-DlogII
Rate<-DlogRate
VAR_data <- window(ts.union(GDP,CPI,Unemployment,Wages,`Balance of Payments`,Consumption,Investment,Rate), start=c(2022,3), end = c(2023,1))
VAR_est <- VAR(y = VAR_data, p = 2)
VAR_est
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
coeftest(VAR2, vcov. = sandwich)
GDP<-DlogGDP
CPI<-DlogCPI
Unemployment<-DlogUnemplyoment
Wages<-DlogWages
`Balance of Payments`<-DlogBOP
Consumption <-DlogCS
Investment<-DlogII
Rate<-DlogRate
VAR_data <- window(ts.union(GDP,CPI,Unemployment,Wages,`Balance of Payments`,Consumption,Investment,Rate), start=c(2022,3), end = c(2023,1))
VAR_est <- VAR(y = VAR_data, p = 2)
VAR_est
forecast <- predict(VAR_est)
par(mar = c(2, 1, 1, 1))
forecast
plot(forecast)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
coeftest(VAR2, vcov. = sandwich)
GDP<-DlogGDP
CPI<-DlogCPI
Unemployment<-DlogUnemplyoment
Wages<-DlogWages
`Balance of Payments`<-DlogBOP
Consumption <-DlogCS
Investment<-DlogII
Rate<-DlogRate
VAR_data <- window(ts.union(GDP,CPI,Unemployment,Wages,`Balance of Payments`,Consumption,Investment,Rate), start=c(2021,3), end = c(2023,1))
VAR_est <- VAR(y = VAR_data, p = 2)
VAR_est
forecast <- predict(VAR_est)
par(mar = c(2, 1, 1, 1))
forecast
plot(forecast)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(1997,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
coeftest(VAR2, vcov. = sandwich)
GDP<-DlogGDP
CPI<-DlogCPI
Unemployment<-DlogUnemplyoment
Wages<-DlogWages
`Balance of Payments`<-DlogBOP
Consumption <-DlogCS
Investment<-DlogII
Rate<-DlogRate
VAR_data <- window(ts.union(GDP,CPI,Unemployment,Wages,`Balance of Payments`,Consumption,Investment,Rate), start=c(2020,3), end = c(2023,1))
VAR_est <- VAR(y = VAR_data, p = 2)
VAR_est
forecast <- predict(VAR_est)
par(mar = c(2, 1, 1, 1))
forecast
plot(forecast)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2)+ L(DlogUnemplyoment, 1:2)+ L(DlogWages, 1:2)+ L(DlogBOP, 1:2)+ L(DlogCS, 1:2)+ L(DlogII, 1:2)+ L(DlogRate, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
coeftest(VAR2, vcov. = sandwich)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2)+ L(DlogUnemplyoment, 1:2)+ L(DlogWages, 1:2)+ L(DlogBOP, 1:2)+ L(DlogCS, 1:2)+ L(DlogII, 1:2)+ L(DlogRate, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2","Unemployment T-1", "Unemployment T-2", "Wages T-1", "Wages T-2", "Net Exports T-1", "Net Exports T-2", "Consumption T-1", "Consumption T-2", "Investment T-1", "Investment T-2","Overnight Rate T-1", "Overnight Rate T-2")
coeftest(VAR2, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2)+ L(DlogUnemplyoment, 1:2)+ L(DlogWages, 1:2)+ L(DlogBOP, 1:2)+ L(DlogCS, 1:2)+ L(DlogII, 1:2)+ L(DlogRate, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2","Unemployment T-1", "Unemployment T-2", "Wages T-1", "Wages T-2", "Net Exports T-1", "Net Exports T-2", "Consumption T-1", "Consumption T-2", "Investment T-1", "Investment T-2","Overnight Rate T-1", "Overnight Rate T-2")
coeftest(VAR2, vcov. = sandwich)
load("C:/Users/clint/Desktop/BOC VAR/combined.Rda")
load("C:/Users/clint/Desktop/BOC VAR/combined.Rda")
View(merged_df)
View(merged_df)
write.xlsx(merged_df, rowNames = TRUE)
install.packages("openxlsx")
# Save the data frame to Excel
write.xlsx(merged_df, file_path, rowNames = TRUE)
# Install the package if not already installed
library(openxlsx)            # Load the package
file_path <- "excel_file.xlsx"
# Save the data frame to Excel
write.xlsx(merged_df, file_path, rowNames = TRUE)
file_path <- "excel_file.xlsx"
# Save the data frame to Excel
write.xlsx(merged_df, file_path, rowNames = TRUE)
# Install the package if not already installed
library(openxlsx)            # Load the package
file_path <- "C:\\Users\\clint\\excel_file.xlsx"
# Save the data frame to Excel
write.xlsx(merged_df, file_path, rowNames = TRUE)
View(merged_df)
View(merged_df)
print(merged_df)
getwd()
View(forecast)
View(forecast)
View(VAR1)
View(VAR1)
View(VAR2)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
load(file='combined.rda')
load(file='combined.rda')
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
inflation <- ts(merged_df$CPI[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCPI <- log(inflation)
DlogCPI = 12*(logCPI - stats::lag(logCPI,n=-1))
unemplyoment <- ts(merged_df$Unemployment[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logUnemplyoment <- log(unemplyoment)
DlogUnemplyoment = 12*(logUnemplyoment - stats::lag(logUnemplyoment,n=-1))
wages <- ts(merged_df$Wages[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logWages <- log(wages)
DlogWages = 12*(logWages - stats::lag(logWages,n=-1))
BOP <- ts(merged_df$`Balance of Payments`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logBOP <- log(BOP)
DlogBOP = 12*(logBOP - stats::lag(logBOP,n=-1))
CS <- ts(merged_df$`Consumption Spending`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logCS <- log(CS)
DlogCS = 12*(logCS - stats::lag(logCS,n=-1))
II <- ts(merged_df$`Inventory Investment`[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logII <- log(II)
DlogII = 12*(logII - stats::lag(logII,n=-1))
rate <- ts(merged_df$Rate[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logRate <- log(rate)
DlogRate = 12*(logRate - stats::lag(logRate,n=-1))
VAR1 <- dynlm(DlogGDP ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR1$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2")
#Notice how we have to restrict the first 2 months to not enter the equation; this is because our data starts in Jan 2000, so there aren't two lags of data until Mar 2000
coeftest(VAR1, vcov. = sandwich)
VAR2 <- dynlm(DlogCPI ~ L(DlogGDP,1:2) + L(DlogCPI, 1:2)+ L(DlogUnemplyoment, 1:2)+ L(DlogWages, 1:2)+ L(DlogBOP, 1:2)+ L(DlogCS, 1:2)+ L(DlogII, 1:2)+ L(DlogRate, 1:2), start = c(2013,3), end = c(2023,1))
names(VAR2$coefficients) <- c("Constant", "GDP T-1", "GDP T-2", "Inflation T-1", "Inflation T-2","Unemployment T-1", "Unemployment T-2", "Wages T-1", "Wages T-2", "Net Exports T-1", "Net Exports T-2", "Consumption T-1", "Consumption T-2", "Investment T-1", "Investment T-2","Overnight Rate T-1", "Overnight Rate T-2")
coeftest(VAR2, vcov. = sandwich)
GDP<-DlogGDP
CPI<-DlogCPI
Unemployment<-DlogUnemplyoment
Wages<-DlogWages
`Balance of Payments`<-DlogBOP
Consumption <-DlogCS
Investment<-DlogII
Rate<-DlogRate
VAR_data <- window(ts.union(GDP,CPI,Unemployment,Wages,`Balance of Payments`,Consumption,Investment,Rate), start=c(2020,3), end = c(2023,1))
VAR_est <- VAR(y = VAR_data, p = 2)
VAR_est
forecast <- predict(VAR_est)
par(mar = c(2, 1, 1, 1))
forecast
plot(forecast)
View(VAR2)
# Load the required libraries
library(dynlm)
library(openxlsx)
# Assuming you have already estimated the 'dynlm' model and stored it in the variable 'model'
# Export the model summary to an Excel file
file_path <- "excel_file.xlsx"
wb <- createWorkbook()
addWorksheet(wb, "Model Summary")
writeData(wb, "Model Summary", summary(VAR2)$coef, startCol = 1, startRow = 1, colNames = TRUE)
saveWorkbook(wb, file_path)
print(logII)
library(readr)
library(dplyr)
gdp <- read_csv("datasets\\growth\\36100434.csv")
gdp <- subset(gdp, VECTOR == "v65201210")
inflation <- read_csv("datasets\\inflation\\18100004.csv")
library(readr)
library(dplyr)
gdp <- read_csv("datasets\\growth\\36100434.csv")
gdp <- subset(gdp, VECTOR == "v65201210")
inflation <- read_csv("datasets\\inflation\\18100004.csv")
bal_of_pay <- bal_of_pay %>% select(REF_DATE, VALUE)
library(zoo)
z <- read.zoo(bal_of_pay, FUN = function(x) as.yearqtr(paste0(x, "-01"), "%Y-%m-%d"))
library(readr)
library(dplyr)
gdp <- read_csv("datasets\\growth\\36100434.csv")
gdp <- subset(gdp, VECTOR == "v65201210")
inflation <- read_csv("datasets\\inflation\\18100004.csv")
library(readr)
library(dplyr)
gdp <- read_csv("datasets\\growth\\36100434.csv")
gdp <- subset(gdp, VECTOR == "v65201210")
inflation <- read_csv("datasets\\inflation\\18100004.csv")
inflation <- subset(inflation, VECTOR == "v41690973")
unemployment <- read_csv("datasets\\unemployment\\1410028701_databaseLoadingData.csv")
unemployment <- subset(unemployment, VECTOR == "v2062814")
Inventory_Investment <- read_csv("datasets\\inventory investmetn\\36100109.csv")
Inventory_Investment <- subset(Inventory_Investment, VECTOR == "v61992666")
wages <- read_csv("datasets\\wages\\1410006301_databaseLoadingData.csv")
wages <- subset(wages, VECTOR == "v2132579")
bal_of_pay <- read_csv("datasets\\balance of payments\\36100018.csv")
bal_of_pay <- subset(bal_of_pay, VECTOR == "v61915304")
cons_spend <- read_csv("datasets\\consumption spending\\36100124.csv")
cons_spend <- subset(cons_spend, VECTOR == "v62700456")
rate <- read_csv("datasets\\Rate.csv")
bal_of_pay <- bal_of_pay %>% select(REF_DATE, VALUE)
cons_spend <- cons_spend %>% select(REF_DATE, VALUE)
wages <- wages %>% select(REF_DATE, VALUE)
Inventory_Investment <- Inventory_Investment %>% select(REF_DATE, VALUE)
unemployment <- unemployment %>% select(REF_DATE, VALUE)
inflation <- inflation %>% select(REF_DATE, VALUE)
gdp <- gdp %>% select(REF_DATE, VALUE)
library(zoo)
z <- read.zoo(bal_of_pay, FUN = function(x) as.yearqtr(paste0(x, "-01"), "%Y-%m-%d"))
Value <- zooreg(na.approx(c(t(cbind(z, NA, NA)))),
start = as.yearmon(start(z)), freq = 12)
bal_of_pay <- fortify.zoo(Value)
z <- read.zoo(cons_spend, FUN = function(x) as.yearqtr(paste0(x, "-01"), "%Y-%m-%d"))
Value <- zooreg(na.approx(c(t(cbind(z, NA, NA)))),
start = as.yearmon(start(z)), freq = 12)
cons_spend <- fortify.zoo(Value)
z <- read.zoo(Inventory_Investment, FUN = function(x) as.yearqtr(paste0(x, "-01"), "%Y-%m-%d"))
Value <- zooreg(na.approx(c(t(cbind(z, NA, NA)))),
start = as.yearmon(start(z)), freq = 12)
Inventory_Investment <- fortify.zoo(Value)
merged_df <- merge(gdp, inflation, by = 'REF_DATE')
merged_df <- merge(merged_df, unemployment, by = 'REF_DATE')
merged_df <- merge(merged_df, wages, by = 'REF_DATE')
merged_df <- setNames(merged_df, c('Date','GDP', 'Inflation','Unemployment','Wages'))
colnames(bal_of_pay)[1] <- 'Date'
colnames(cons_spend)[1] <- 'Date'
colnames(Inventory_Investment)[1] <- 'Date'
colnames(rate)[1] <- 'Date'
rate$Date <- as.yearmon(rate$Date, format = "%y-%b")
merged_df$Date <- as.yearmon(merged_df$Date, format = "%Y-%m")
merged_df <- merge(merged_df, bal_of_pay, by = 'Date')
merged_df <- merge(merged_df, cons_spend, by = 'Date')
merged_df <- merge(merged_df, Inventory_Investment, by = 'Date')
merged_df <- merge(merged_df, rate, by = 'Date')
merged_df <- setNames(merged_df, c('Date','GDP', 'CPI','Unemployment','Wages','Balance of Payments','Consumption Spending','Inventory Investment','Rate'))
library(openxlsx)
file_path <- "combined.xlsx"
write.xlsx(data, file = file_path, rowNames = TRUE)
library(openxlsx)
file_path <- "combined.xlsx"
write.xlsx(merged_df, file = file_path, rowNames = TRUE)
load(file='combined.rda')
library(quantmod)
library(dynlm)
library(lmtest)
library(sandwich)
library(vars)
GDP <- ts(merged_df$GDP[(merged_df$Date >= "Jan 2013") & (merged_df$Date <= "Jan 2023")], start=c(2013,1),end=c(2023,1),frequency=12)
logGDP <- log(GDP)
DlogGDP = 12*(logGDP - stats::lag(logGDP,n=-1))
